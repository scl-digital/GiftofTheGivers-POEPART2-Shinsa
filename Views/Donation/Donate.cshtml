@model DisasterAlleviationFoundation.Models.DonationViewModel

@{
    ViewData["Title"] = "Make a Donation";
}

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow">
                <div class="card-header">
                    <h2 class="mb-0">
                        <i class="fas fa-donate me-2"></i>
                        Make a Donation
                    </h2>
                    <p class="mb-0 mt-2">Donate resources (food, clothing, medical) or make a financial contribution.</p>
                </div>

                <div class="card-body p-4">
                    <form asp-action="Donate" method="post">
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label asp-for="Type" class="form-label fw-bold">Donation Type</label>
                                <select asp-for="Type" class="form-select">
                                    <option value="@DisasterAlleviationFoundation.Models.DonationType.Financial">Financial</option>
                                    <option value="@DisasterAlleviationFoundation.Models.DonationType.Resource">Resource</option>
                                    <option value="@DisasterAlleviationFoundation.Models.DonationType.Mixed">Mixed</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="UrgencyLevel" class="form-label fw-bold">Urgency</label>
                                <select asp-for="UrgencyLevel" class="form-select">
                                    <option value="@DisasterAlleviationFoundation.Models.UrgencyLevel.Normal">Normal</option>
                                    <option value="@DisasterAlleviationFoundation.Models.UrgencyLevel.High">High</option>
                                    <option value="@DisasterAlleviationFoundation.Models.UrgencyLevel.Critical">Critical</option>
                                    <option value="@DisasterAlleviationFoundation.Models.UrgencyLevel.Emergency">Emergency</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="TargetArea" class="form-label fw-bold">Target Area</label>
                                <input asp-for="TargetArea" class="form-control" placeholder="Affected area or location" />
                            </div>
                        </div>

                        <div class="mb-4 p-3 border rounded">
                            <h5 class="fw-bold">
                                <i class="fas fa-hand-holding-usd me-2"></i>Financial Donation
                            </h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label asp-for="Amount" class="form-label">Amount</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input asp-for="Amount" type="number" step="0.01" class="form-control" />
                                    </div>
                                    <span asp-validation-for="Amount" class="text-danger"></span>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label asp-for="PaymentMethod" class="form-label">Payment Method</label>
                                    <select asp-for="PaymentMethod" class="form-select">
                                        <option value="">Select</option>
                                        <option value="@DisasterAlleviationFoundation.Models.PaymentMethod.CreditCard">Credit Card</option>
                                        <option value="@DisasterAlleviationFoundation.Models.PaymentMethod.BankTransfer">Bank Transfer</option>
                                        <option value="@DisasterAlleviationFoundation.Models.PaymentMethod.PayPal">PayPal</option>
                                        <option value="@DisasterAlleviationFoundation.Models.PaymentMethod.Cash">Cash</option>
                                    </select>
                                    <span asp-validation-for="PaymentMethod" class="text-danger"></span>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="form-check mt-4">
                                        <input asp-for="ReceiptRequired" class="form-check-input" type="checkbox" />
                                        <label asp-for="ReceiptRequired" class="form-check-label">Receipt Required</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4 p-3 border rounded">
                            <h5 class="fw-bold">
                                <i class="fas fa-boxes me-2"></i>Resource Donation
                            </h5>
                            <div id="resource-list">
                                @if (Model.Resources != null && Model.Resources.Any())
                                {
                                    for (int i = 0; i < Model.Resources.Count; i++)
                                    {
                                        <partial name="_ResourceDonationItem" for="Resources[i]" />
                                    }
                                }
                            </div>
                            <button type="button" class="btn btn-outline-dark" id="add-resource-btn">
                                <i class="fas fa-plus me-2"></i>Add Resource Item
                            </button>
                        </div>

                        <div class="mb-4 p-3 border rounded">
                            <h5 class="fw-bold">
                                <i class="fas fa-truck me-2"></i>Delivery / Pickup
                            </h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label asp-for="DeliveryMethod" class="form-label">Delivery Method</label>
                                    <select asp-for="DeliveryMethod" class="form-select">
                                        <option value="@DisasterAlleviationFoundation.Models.DeliveryMethod.DropOff">Drop-off</option>
                                        <option value="@DisasterAlleviationFoundation.Models.DeliveryMethod.Pickup">Pickup</option>
                                        <option value="@DisasterAlleviationFoundation.Models.DeliveryMethod.Shipping">Shipping</option>
                                        <option value="@DisasterAlleviationFoundation.Models.DeliveryMethod.DirectDelivery">Direct Delivery</option>
                                    </select>
                                </div>
                                <div class="col-md-8 mb-3">
                                    <div class="form-check">
                                        <input asp-for="RequiresPickup" class="form-check-input" type="checkbox" />
                                        <label asp-for="RequiresPickup" class="form-check-label">Request Pickup</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-8 mb-3">
                                    <label asp-for="PickupAddress" class="form-label">Pickup Address</label>
                                    <input asp-for="PickupAddress" class="form-control" />
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label asp-for="PreferredPickupDate" class="form-label">Preferred Pickup Date</label>
                                    <input asp-for="PreferredPickupDate" type="date" class="form-control" />
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label asp-for="SpecialInstructions" class="form-label">Special Instructions</label>
                            <textarea asp-for="SpecialInstructions" class="form-control" rows="3" placeholder="Any notes for our team"></textarea>
                        </div>

                        <div class="d-flex justify-content-between">
                            <a asp-controller="Dashboard" asp-action="Index" class="btn">
                                <i class="fas fa-arrow-left me-2"></i>Cancel
                            </a>
                            <button type="submit" class="btn btn-lg">
                                <i class="fas fa-paper-plane me-2"></i>Submit Donation
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.getElementById('add-resource-btn')?.addEventListener('click', async () => {
            const resp = await fetch('@Url.Action("AddResourceItem", "Donation")');
            const html = await resp.text();
            const container = document.getElementById('resource-list');
            if (container) {
                const temp = document.createElement('div');
                temp.innerHTML = html;
                container.appendChild(temp.firstElementChild);
            }
        });
    </script>
}


